$ ->
  $("[data-raty]").raty
    path: ""
    starOff: "<%= image_path('raty/lib/images/star-off.png') %>"
    starOn: "<%= image_path('raty/lib/images/star-on.png') %>"
    number: 10
    hints: [
      "1"
      "2"
      "3"
      "4"
      "5"
      "6"
      "7"
      "8"
      "9"
      "10"
    ],
    target: -> ".raty-target"
    targetFormat: "<span class='raty-target-score'>{score}</span>/10"
    targetKeep: true
    score: -> $(@).data("score")
    click: (score, e) ->
      $(".raty-pending").fadeIn()
      $(".raty-success").hide()
      $(".raty-fail").hide()

      params =
        rating:
          movie_id: $(@).data("movie-id")
          rating: score

      request = $.post "/ratings.json", params
      request.success ->
        $(".raty-pending").fadeOut(-> $(".raty-success").fadeIn())
      request.fail ->
        $(".raty-pending").fadeOut(-> $(".raty-fail").fadeIn())


